clear all; close all; clc;

% Para os coeficientes de Momento empenas
% A = [ -0.018  -0.052  -0.052  -0.052  -0.054  -0.049  -0.059  -0.051  -0.030  -0.037  -0.026  -0.013;
%       -0.028  -0.051  -0.043  -0.046  -0.045  -0.049  -0.057  -0.052  -0.030  -0.033  -0.030  -0.008;
%       -0.037  -0.041  -0.038  -0.040  -0.040  -0.038  -0.037  -0.030  -0.027  -0.024  -0.019  -0.013;
%       -0.048  -0.045  -0.045  -0.045  -0.044  -0.045  -0.047  -0.048  -0.049  -0.045  -0.033  -0.016;
%       -0.043  -0.044  -0.041  -0.041  -0.040  -0.038  -0.034  -0.035  -0.035  -0.029  -0.022  -0.009;
%       -0.052  -0.034  -0.036  -0.036  -0.035  -0.028  -0.024  -0.023  -0.020  -0.016  -0.010  -0.014;
%       -0.062  -0.034  -0.027  -0.028  -0.027  -0.027  -0.023  -0.023  -0.019  -0.009  -0.025  -0.010;];
  
% % Para os coeficientes de Força.
% A = [ -0.099  -0.081  -0.081  -0.063  -0.025  0.044  0.097  0.113  0.145  0.167  0.174  0.166;
%       -0.048  -0.038  -0.040  -0.021   0.016  0.083  0.127  0.137  0.162  0.177  0.179  0.167;
%       -0.022  -0.020  -0.021  -0.004   0.032  0.094  0.128  0.130  0.154  0.161  0.155  0.138;
%       -0.040  -0.038  -0.039  -0.025   0.006  0.062  0.087  0.085  0.100  0.110  0.104  0.091;
%       -0.083  -0.073  -0.076  -0.072  -0.046  0.012  0.024  0.025  0.043  0.053  0.047  0.040];  
  
  
% Para os coeficientes de Momento
A = [   0.000   0.000   0.000   0.000   0.000   0.000   0.000   0.000   0.000   0.000   0.000   0.000;
       -0.001  -0.004  -0.008  -0.012  -0.016  -0.019  -0.020  -0.020  -0.015  -0.008  -0.013  -0.015;
       -0.003  -0.009  -0.017  -0.024  -0.030  -0.034  -0.040  -0.037  -0.016  -0.002  -0.010  -0.019;
       -0.001  -0.010  -0.020  -0.030  -0.039  -0.044  -0.050  -0.049  -0.023  -0.006  -0.014  -0.027;
        0.000  -0.010  -0.022  -0.034  -0.047  -0.046  -0.059  -0.061  -0.033  -0.036  -0.035  -0.035;
        0.007  -0.010  -0.023  -0.034  -0.049  -0.046  -0.068  -0.071  -0.060  -0.058  -0.062  -0.059;
        0.009  -0.011  -0.023  -0.037  -0.050  -0.047  -0.074  -0.079  -0.091  -0.076  -0.077  -0.076];
    
% Construção da superfícies de interpolação.  
ALPHA = linspace(-10, 45, 12);
% BETA  = linspace(-30, 30, 7);
BETA  = linspace(0, 30, 7);
ELEVATOR = linspace(-25, 25, 5);
% mesh(ALPHA, BETA, A);
mesh(ALPHA, BETA, A);

% Ponto de interesse.
alpha = 19;
beta  = 2;
elevator = -20;

% Para os coeficientes de momento.
% % Encontrando a célula de interpolação.
% % 'AoA'.
% S = alpha/5;
% x = floor(S);
% if(x <= -2)
%     x = -2;
% end
% if(x >= 9)
%     x = 8;
% end
% 
% % 'beta'
% S = beta/10;
% y = floor(S);
% if(y <= -3)
%     y = -3;
% end
% if(y >= 3)
%     y = 2;
% end



% Encontrando a célula de interpolação.
% 'AoA'.
S = alpha/5;
x = floor(S);
if(x <= -2)
    x = -2;
end
if(x >= 9)
    x = 8;
end
 
% 'beta'
S = beta/5;
y = floor(S);
if(y <= 0)
    y = 0;
end
if(y >= 7)
    y = 6;
end

% Valores dos retângulos.
x1 = 5*x;
x2 = 5*(x+1);
y1 = 5*y;
y2 = 5*(y+1);


% Ajuste para pegar os valores das tabelas.
xc = x + 3;
yc = y + 1;
Q11 = A(yc, xc);
Q12 = A(yc+1, xc);
Q21 = A(yc, xc+1);
Q22 = A(yc+1, xc+1);

hold on;
plot3(x1, y1, Q11, 'k*');
plot3(x1, y2, Q12, 'k*');
plot3(x2, y1, Q21, 'k*');
plot3(x2, y2, Q22, 'k*');

% 5. Realiza o cálculo da interpolação.
Q = [Q11 Q12;
     Q21 Q22];
X = [ x1 1;
      x2 1];
Y = [ y1 1;
      y2 1];

CoeficienteYawingMomentRudder = [beta 1]*inv(Y)*(Q')*inv(X)'*[alpha 1]'
plot3(alpha, beta, CoeficienteYawingMomentRudder, 'k*');
