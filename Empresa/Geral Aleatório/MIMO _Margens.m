clear all; close all; clc;

A = [  -0.08527   -0.0001423    -0.9994    0.04142          0    0.1862;
         -46.86       -2.757     0.3896          0     -124.3     128.6;
        -0.4248     -0.06224   -0.06714          0     -8.792    -20.46;
              0            1          0          0          0         0;
              0            0          0          0       20.0         0;
              0            0          0          0          0      20.0];
          
B = [ 0     0;
      0     0;
      0     0;
      0     0;
      1     0;
      0     1];
  
C = [ 0      1      0      0      0     0;
      0   0.07      1      0      0     0];
  
D = zeros(2,2);

% Matrizes do sistema.
G = minreal(tf(ss(A,B,C,D)));

g = tf([0.1491],[1 0]);
p = 2.058*tf([1 0], [1 2]);

% No elevator.
K = p*G(2,1)/(1 - p*G(2,2));
L = minreal(g*G(1,1) + g*G(1,2)*K);

% No rudder.
Kl = g*G(1,2)/(1 - g*G(1,1));
Ll = p*G(2,1)*Kl + p*G(2,2);

nyquist(Ll)




